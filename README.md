# spring-microservice-oauth2-keycloak-starter

For detailed tutorial, please refer to the post.  
https://kunkkali.blogspot.com/2020/10/build-j2ee-micro-services-architecture.html

## docker-compose.yml
Replace host ip inside with your own, then run the following cmd to start:

`docker-compose up --build`

Navigate to the following url, then Login keycloak with dev/123

`localhost:8080/api/consume/`

## Fetch access token and refresh token from keycloak server
Post a request to get an access token:

`POST http://localhost:18080/auth/realms/spring-micro-main/protocol/openid-connect/token`  
 `Content-Type: application/x-www-form-urlencoded`
 
 `&client_id=spring-micro-gateway&username=dev&password=123&grant_type=password&client_secret=756b0558-018b-4809-b478-bd5b4995d325`

## Test API
Get request with bearer token:

`GET localhost:8080/api/produce/`  
 `Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJPc3NGcVFWNUc1TWo0R3hsVVNUZXB3eE9HTEZZeUtLNklFTXRGdVlFV1VJIn0.eyJleHAiOjE2MDI0OTY1MzAsImlhdCI6MTYwMjQ5NjIzMCwiYXV0aF90aW1lIjoxNjAyNDk0MzU5LCJqdGkiOiJhN2ZiYjk3Ni0yZTFmLTQ4YmMtOWUxZi03YjJjYmM4ODg0ZTEiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjE4MDgwL2F1dGgvcmVhbG1zL3NwcmluZy1taWNyby1tYWluIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmNTAyMTNiLTQ2NjEtNDZiNS1iMmUzLWI4M2FiY2JkNmIzMiIsInR5cCI6IkJlYXJlciIsImF6cCI6InNwcmluZy1taWNyby1nYXRld2F5Iiwibm9uY2UiOiJydDFyRmtVOGJ4V2ZfMlA2STJzV1N6YTYtY3RUSjVpcGd0dFdjVmpaVTZ3Iiwic2Vzc2lvbl9zdGF0ZSI6ImM3Y2FkOTM4LWEyYjMtNGQxZC1iOWZkLWU4ZDQ3NDBmNjIxZiIsImFjciI6IjAiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIGVtYWlsIHByb2ZpbGUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJkZXYiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkZXYiLCJnaXZlbl9uYW1lIjoiZGV2IiwiZW1haWwiOiJkZXZAZ21haWwuY29tIn0.hBpizRxCwcMqnRZvSsV-YB5As3YbO05xFCSLW4D9A7wBMAXs4ZcoIOnP7NveiZj0vxx-D6wjKAOyMiaFJLMvfiyPnLh4LyQN2u3ZYqc9JQXM-exRIQTFMB1cibtK3DCOG6JPptL0gUTlI58oCNsRX6hzuUPeuqZpLtM4NnVbGNoZQeYy8y7Z-vefq2rV4Gp3tBh2VRfkhJg1dm7j4iEJs85sgPHJ6-x_RpEqEfpQRCkXctQ3NeLqXUblflwDLX8onfF3xBpmjty5Mxh-HWrH9I-HKIFB28w8apD4q9WRc_7XAGnOqWizPZs6i7YyPqUqnwanWS93u1eYSyWRKK-FzQ`
